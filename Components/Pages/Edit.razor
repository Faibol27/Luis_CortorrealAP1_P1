@page "/Edit/"
@rendermode InteractiveServer

@inject EntradasHuacalesServices Services
@inject IToastService Toast



<EditForm Model="Huacales" OnValidSubmit="Modificar">
	<DataAnnotationsValidator />

	<div class="container ">
		<div class=" card shadow-lg">
			<div class="card-header shadow-lg">
				<div class="text-center">
					<h1>Editar Huacales</h1>
				</div>
			</div>
			<div class="card-body">

				<div class="mb-3">
					<label class="form-label"><strong>Nombre Cliente</strong></label>
					<InputText class="form-control" @bind-Value="Huacales.NombreCliente"></InputText>
					<ValidationMessage For="(() => Huacales.NombreCliente)" />
				</div>

				<div class="mb-3">
					<label class="form-label"><strong>Fecha</strong></label>
					<InputDate class="form-control" @bind-Value="Huacales.Fecha"></InputDate>
					<ValidationMessage For="(() => Huacales.Fecha)" />
				</div>

				<div class="mb-3">
					<label class=" form-label"><strong>Cantidad</strong></label>
					<InputNumber class="form-control" @bind-Value="Huacales.Cantidad"></InputNumber>
					<ValidationMessage For="(() => Huacales.Cantidad)" />
				</div>
				<div class="mb-3">
					<label class=" form-label"><strong>Precio</strong></label>
					<InputNumber class="form-control" @bind-Value="Huacales.Precio"></InputNumber>
					<ValidationMessage For="(() => Huacales.Precio)" />
				</div>
			</div>
			<div class="card-footer text-center">
				<a href="/Index" class="btn btn-secondary">
					<i class="bi bi-square"></i>Volver
				</a>
				<button class=" btn btn-primary">
					<i class="bi bi-square"></i>Modificar
				</button>
				<button class=" btn btn-primary">
					<i class="bi bi-square" @onclick="Eliminar"></i>Eliminar
				</button>
			</div>
		</div>
	</div>
</EditForm>


@code {
	[SupplyParameterFromQuery]
	public int IdEntrada { get; set; }
	public EntradasHuacales Huacales = new EntradasHuacales();

	protected override async Task OnInitializedAsync()
	{
		if (IdEntrada > 0)
		{
			var encontrado = await Services.Buscar(IdEntrada);
			if (encontrado != null)
			{
				Huacales = encontrado;
			}
			else
			{
				Toast.ShowError("Registro no encontrado");
			}
		}
	}

	public async Task Modificar()
	{
		var modificado = await Services.Modificar(Huacales);
		if (modificado)
		{
			Toast.ShowSuccess("Modificado Correctamente");
		}
		else
		{
			Toast.ShowError("No se pudo modificar");
		}
	}
	public async Task Eliminar()
	{
		var eliminado = await Services.Eliminar(IdEntrada);
		if (eliminado)
		{
			Toast.ShowSuccess("Eliminado");
		}
		else
		{
			Toast.ShowError("No se pudo eliminar");	
		}

	}

}
